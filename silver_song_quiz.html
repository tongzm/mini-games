<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>è€æ­ŒçŒœçŒœä¹</title>
    <style>
        :root {
            --bg-color: #FFF8E7;
            --primary-color: #D32F2F; /* ä¸­å›½çº¢ */
            --accent-color: #FFD700; /* é‡‘è‰² */
            --text-dark: #3E2723;
            --text-black: #000000;
            --btn-height: 120px;
            --btn-gap: 40px;
        }

        * {
            box-sizing: border-box;
            user-select: none; /* é˜²æ­¢é•¿æŒ‰é€‰ä¸­æ–‡æœ¬ */
            -webkit-tap-highlight-color: transparent;
        }

        body {
            margin: 0;
            padding: 0;
            background-color: var(--bg-color);
            font-family: "PingFang SC", "Microsoft YaHei", sans-serif;
            color: var(--text-dark);
            height: 100vh;
            display: flex;
            flex-direction: column;
            overflow: hidden;
        }

        /* é€šç”¨å¤§å­—ä½“ */
        .text-huge { font-size: 60px; font-weight: bold; }
        .text-large { font-size: 48px; font-weight: bold; }
        .text-body { font-size: 40px; }

        /* å®¹å™¨ */
        #app {
            flex: 1;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            padding: 20px;
            width: 100%;
            max-width: 600px; /* é™åˆ¶åœ¨å¤§å±ä¸Šçš„å®½åº¦ï¼Œä¿æŒæ‰‹æœºæ¯”ä¾‹ */
            margin: 0 auto;
            position: relative;
        }

        /* å±å¹•åˆ‡æ¢ */
        .screen {
            display: none;
            width: 100%;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            height: 100%;
        }

        .screen.active {
            display: flex;
        }

        /* æŒ‰é’®é€šç”¨æ ·å¼ */
        .btn {
            background-color: var(--primary-color);
            color: #fff;
            border: none;
            border-radius: 20px;
            font-size: 50px;
            font-weight: bold;
            width: 90%;
            height: var(--btn-height);
            display: flex;
            align-items: center;
            justify-content: center;
            box-shadow: 0 10px 0 #9A0007; /* ç«‹ä½“æ„Ÿ */
            transition: transform 0.1s, box-shadow 0.1s;
            cursor: pointer;
            margin-bottom: var(--btn-gap);
            text-align: center;
            line-height: 1.2;
        }

        .btn:active {
            transform: translateY(5px);
            box-shadow: 0 5px 0 #9A0007;
        }

        .btn.secondary {
            background-color: var(--accent-color);
            color: var(--text-dark);
            box-shadow: 0 10px 0 #C79100;
        }
        .btn.secondary:active {
            box-shadow: 0 5px 0 #C79100;
        }

        /* å¼€å§‹å±å¹• */
        #start-screen h1 {
            color: var(--primary-color);
            margin-bottom: 60px;
            text-shadow: 2px 2px 0 #fff;
            text-align: center;
        }

        /* æ¸¸æˆå±å¹• */
        #level-indicator {
            font-size: 36px;
            margin-bottom: 20px;
            color: #795548;
        }

        #music-player {
            width: 90%;
            background: #fff;
            border: 4px solid var(--primary-color);
            border-radius: 30px;
            padding: 40px 20px;
            margin-bottom: 60px;
            display: flex;
            flex-direction: column;
            align-items: center;
            position: relative;
        }

        .speaker-icon {
            font-size: 80px;
            margin-bottom: 20px;
            animation: pulse 1s infinite alternate;
        }

        @keyframes pulse {
            from { transform: scale(1); opacity: 0.8; }
            to { transform: scale(1.1); opacity: 1; }
        }

        .music-status {
            font-size: 32px;
            color: #666;
            text-align: center;
            margin-top: 10px;
        }

        /* é€‰é¡¹åŒºåŸŸ */
        #options-container {
            width: 100%;
            display: flex;
            flex-direction: column;
            align-items: center;
        }

        /* é€‰é¡¹çŠ¶æ€ */
        .btn.correct {
            background-color: #4CAF50 !important;
            box-shadow: 0 10px 0 #2E7D32 !important;
            animation: bounce 0.5s;
        }
        
        .btn.wrong {
            background-color: #9E9E9E !important;
            box-shadow: 0 10px 0 #616161 !important;
            opacity: 0.8;
        }

        @keyframes bounce {
            0%, 20%, 50%, 80%, 100% {transform: translateY(0);}
            40% {transform: translateY(-20px);}
            60% {transform: translateY(-10px);}
        }

        /* å¼¹çª— (Modal) */
        #result-modal {
            position: fixed;
            top: 0; left: 0; right: 0; bottom: 0;
            background: rgba(0,0,0,0.8);
            display: none;
            align-items: center;
            justify-content: center;
            z-index: 100;
        }

        .modal-content {
            background: var(--bg-color);
            border: 8px solid var(--primary-color);
            border-radius: 40px;
            padding: 40px;
            width: 90%;
            max-width: 500px;
            text-align: center;
            animation: popIn 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.275);
        }

        @keyframes popIn {
            from { transform: scale(0.5); opacity: 0; }
            to { transform: scale(1); opacity: 1; }
        }

        .modal-icon {
            font-size: 100px;
            margin-bottom: 20px;
            display: block;
        }

        .modal-title {
            font-size: 60px;
            color: var(--primary-color);
            margin-bottom: 20px;
            font-weight: bold;
        }

        .modal-desc {
            font-size: 40px;
            color: var(--text-dark);
            margin-bottom: 40px;
        }

        /* è°ƒè¯•/Fallback ä¿¡æ¯ */
        #debug-info {
            font-size: 24px;
            color: #999;
            margin-top: 10px;
            text-align: center;
            border-top: 1px dashed #ccc;
            padding-top: 10px;
            width: 100%;
        }

    </style>
</head>
<body>

    <div id="app">
        <!-- å¼€å§‹ç”»é¢ -->
        <div id="start-screen" class="screen active">
            <h1 class="text-huge">ğŸµ è€æ­ŒçŒœçŒœä¹</h1>
            <div style="font-size: 100px; margin-bottom: 60px;">ğŸ“»</div>
            <button class="btn" onclick="game.start()">å¼€å§‹çŒœæ­Œ</button>
            <p class="text-body" style="margin-top:40px; opacity: 0.7;">ä¸“ä¸ºé“¶å‘æ—è®¾è®¡</p>
        </div>

        <!-- æ¸¸æˆç”»é¢ -->
        <div id="game-screen" class="screen">
            <div id="level-indicator">ç¬¬ <span id="current-level-num">1</span>/20 é¢˜</div>
            
            <div id="music-player">
                <div class="speaker-icon">ğŸ”Š</div>
                <div class="text-large" style="color:var(--primary-color)">æ­£åœ¨æ’­æ”¾...</div>
                <button class="btn secondary" style="margin-top: 30px; height: 100px; font-size:40px; width: 80%;" onclick="game.playMusic()">
                    ğŸ”„ é‡å¬ä¸€é
                </button>
                <div id="debug-info" style="display:none;"></div>
            </div>

            <div id="options-container">
                <!-- é€‰é¡¹å°†ç”± JS åŠ¨æ€ç”Ÿæˆ -->
            </div>
        </div>
    </div>

    <!-- ç»“ç®—å¼¹çª— -->
    <div id="result-modal">
        <div class="modal-content">
            <span class="modal-icon" id="modal-icon">ğŸ‰</span>
            <div class="modal-title" id="modal-title">å¤ªæ£’äº†ï¼</div>
            <div class="modal-desc" id="modal-desc">å®Œå…¨æ­£ç¡®</div>
            <button class="btn" onclick="game.nextLevel()">ä¸‹ä¸€é¦–</button>
        </div>
    </div>

    <!-- éŸ³é¢‘æ ‡ç­¾ -->
    <audio id="audio-player"></audio>

<script>
/**
 * é¢˜åº“æ•°æ®
 */
const GAME_DATA = [
  { "id": 1, "file": "assets/music/song_1.mp3", "title": "ä¸œæ–¹çº¢", "options": ["ä¸œæ–¹çº¢", "å—æ³¥æ¹¾", "æ˜ å±±çº¢"], "answer": "ä¸œæ–¹çº¢", "hint": "æ­Œè¯ç¬¬ä¸€å¥ï¼šä¸œæ–¹çº¢ï¼Œå¤ªé˜³å‡..." },
  { "id": 2, "file": "assets/music/song_2.mp3", "title": "ç”œèœœèœœ", "options": ["å°åŸæ•…äº‹", "ç”œèœœèœœ", "æœˆäº®ä»£è¡¨æˆ‘çš„å¿ƒ"], "answer": "ç”œèœœèœœ", "hint": "é‚“ä¸½å›çš„ç»å…¸ç”œæ­Œï¼Œç¬‘å®¹åƒèŠ±å„¿ä¸€æ ·ã€‚" },
  { "id": 3, "file": "assets/music/song_3.mp3", "title": "æˆ‘çš„ç¥–å›½", "options": ["è‹±é›„èµæ­Œ", "æˆ‘çš„ç¥–å›½", "ç¥–å›½é¢‚"], "answer": "æˆ‘çš„ç¥–å›½", "hint": "ç”µå½±ã€Šä¸Šç”˜å²­ã€‹æ’æ›²ï¼Œä¸€æ¡å¤§æ²³æ³¢æµªå®½..." },
  { "id": 4, "file": "assets/music/song_4.mp3", "title": "å¥½æ—¥å­", "options": ["å¥½è¿æ¥", "å¥½æ—¥å­", "è¾£å¦¹å­"], "answer": "å¥½æ—¥å­", "hint": "å®‹ç¥–è‹±æ¼”å”±ï¼Œå–œåº†çš„æ—¶å€™ç»å¸¸æ”¾ã€‚" },
  { "id": 5, "file": "assets/music/song_5.mp3", "title": "èŒ‰è‰èŠ±", "options": ["èŒ‰è‰èŠ±", "ç‰¡ä¸¹ä¹‹æ­Œ", "åœ¨é‚£æ¡ƒèŠ±ç››å¼€çš„åœ°æ–¹"], "answer": "èŒ‰è‰èŠ±", "hint": "å¥½ä¸€æœµç¾ä¸½çš„..." },
  { "id": 6, "file": "assets/music/song_6.mp3", "title": "å¸¸å›å®¶çœ‹çœ‹", "options": ["å¸¸å›å®¶çœ‹çœ‹", "çˆ¶äº²", "çƒ›å…‰é‡Œçš„å¦ˆå¦ˆ"], "answer": "å¸¸å›å®¶çœ‹çœ‹", "hint": "æ˜¥æ™šç»å…¸ï¼Œæ‰¾ç‚¹ç©ºé—²ï¼Œæ‰¾ç‚¹æ—¶é—´..." },
  { "id": 7, "file": "assets/music/song_7.mp3", "title": "éš¾å¿˜ä»Šå®µ", "options": ["ä»Šå¤œæ— çœ ", "éš¾å¿˜ä»Šå®µ", "ç›¸çº¦ä¸€ä¹ä¹å…«"], "answer": "éš¾å¿˜ä»Šå®µ", "hint": "æ¯å¹´æ˜¥æ™šç»“æŸæ—¶éƒ½ä¼šå”±çš„æ­Œã€‚" },
  { "id": 8, "file": "assets/music/song_8.mp3", "title": "æœˆäº®ä»£è¡¨æˆ‘çš„å¿ƒ", "options": ["æ°ä¼¼ä½ çš„æ¸©æŸ”", "æœˆäº®ä»£è¡¨æˆ‘çš„å¿ƒ", "å¤œæ¥é¦™"], "answer": "æœˆäº®ä»£è¡¨æˆ‘çš„å¿ƒ", "hint": "ä½ é—®æˆ‘çˆ±ä½ æœ‰å¤šæ·±..." },
  { "id": 9, "file": "assets/music/song_9.mp3", "title": "åŒ—å›½ä¹‹æ˜¥", "options": ["åŒ—å›½ä¹‹æ˜¥", "æ¦•æ ‘ä¸‹", "æ•…ä¹¡çš„äº‘"], "answer": "åŒ—å›½ä¹‹æ˜¥", "hint": "è’‹å¤§ä¸ºæ¼”å”±ï¼Œäº­äº­ç™½æ¡¦ï¼Œæ‚ æ‚ ç¢§ç©º..." },
  { "id": 10, "file": "assets/music/song_10.mp3", "title": "æ•–åŒ…ç›¸ä¼š", "options": ["è‰åŸä¸Šå‡èµ·ä¸è½çš„å¤ªé˜³", "æ•–åŒ…ç›¸ä¼š", "é¸¿é›"], "answer": "æ•–åŒ…ç›¸ä¼š", "hint": "ç”µå½±ã€Šè‰åŸä¸Šçš„äººä»¬ã€‹æ’æ›²ï¼Œåäº”çš„æœˆäº®å‡ä¸Šäº†å¤©ç©º..." },
  { "id": 11, "file": "assets/music/song_11.mp3", "title": "æ™ºå–å¨è™å±±", "options": ["çº¢ç¯è®°", "æ²™å®¶æµœ", "æ™ºå–å¨è™å±±"], "answer": "æ™ºå–å¨è™å±±", "hint": "äº¬å‰§æ ·æ¿æˆï¼Œæ‰“è™ä¸Šå±±..." },
  { "id": 12, "file": "assets/music/song_12.mp3", "title": "æ˜¥å¤©çš„æ•…äº‹", "options": ["èµ°è¿›æ–°æ—¶ä»£", "æ˜¥å¤©çš„æ•…äº‹", "ç¥é…’æ­Œ"], "answer": "æ˜¥å¤©çš„æ•…äº‹", "hint": "1979å¹´ï¼Œé‚£æ˜¯ä¸€ä¸ªæ˜¥å¤©..." },
  { "id": 13, "file": "assets/music/song_13.mp3", "title": "æ´ªæ¹–æ°´æµªæ‰“æµª", "options": ["æ´ªæ¹–æ°´æµªæ‰“æµª", "å¾®å±±æ¹–", "çŠç‘šé¢‚"], "answer": "æ´ªæ¹–æ°´æµªæ‰“æµª", "hint": "æ­Œå‰§ã€Šæ´ªæ¹–èµ¤å«é˜Ÿã€‹é€‰æ›²ã€‚" },
  { "id": 14, "file": "assets/music/song_14.mp3", "title": "é’è—é«˜åŸ", "options": ["å¤©è·¯", "é’è—é«˜åŸ", "ç ç©†æœ—ç›"], "answer": "é’è—é«˜åŸ", "hint": "æå¨œ/éŸ©çº¢æ¼”å”±ï¼Œæ˜¯è°å¸¦æ¥è¿œå¤çš„å‘¼å”¤..." },
  { "id": 15, "file": "assets/music/song_15.mp3", "title": "å—æ³¥æ¹¾", "options": ["å—æ³¥æ¹¾", "åœ°é“æˆ˜", "æ¸¸å‡»é˜Ÿæ­Œ"], "answer": "å—æ³¥æ¹¾", "hint": "èŠ±ç¯®çš„èŠ±å„¿é¦™..." },
  { "id": 16, "file": "assets/music/song_16.mp3", "title": "åº·å®šæƒ…æ­Œ", "options": ["åº·å®šæƒ…æ­Œ", "æ€èµ·ä½ çš„ç›–å¤´æ¥", "è¾¾å‚åŸçš„å§‘å¨˜"], "answer": "åº·å®šæƒ…æ­Œ", "hint": "è·‘é©¬æºœæºœçš„å±±ä¸Š..." },
  { "id": 17, "file": "assets/music/song_17.mp3", "title": "å†¬å¤©é‡Œçš„ä¸€æŠŠç«", "options": ["å†¬å¤©é‡Œçš„ä¸€æŠŠç«", "æ¼äººçš„ç§‹é£", "çƒ­æƒ…çš„æ²™æ¼ "], "answer": "å†¬å¤©é‡Œçš„ä¸€æŠŠç«", "hint": "è´¹ç¿”åœ¨æ˜¥æ™šå”±çº¢çš„æ­Œï¼Œä½ å°±åƒé‚£..." },
  { "id": 18, "file": "assets/music/song_18.mp3", "title": "åäº”çš„æœˆäº®", "options": ["åäº”çš„æœˆäº®", "æœ›æ˜Ÿç©º", "è¡€æŸ“çš„é£é‡‡"], "answer": "åäº”çš„æœˆäº®", "hint": "å†›åŠŸç« æœ‰ä½ çš„ä¸€åŠï¼Œä¹Ÿæœ‰æˆ‘çš„ä¸€åŠã€‚" },
  { "id": 19, "file": "assets/music/song_19.mp3", "title": "è®©æˆ‘ä»¬è¡èµ·åŒæ¡¨", "options": ["è®©æˆ‘ä»¬è¡èµ·åŒæ¡¨", "å¬å¦ˆå¦ˆè®²é‚£è¿‡å»çš„äº‹æƒ…", "æ­Œå£°ä¸å¾®ç¬‘"], "answer": "è®©æˆ‘ä»¬è¡èµ·åŒæ¡¨",
    "hint": "å°èˆ¹å„¿æ¨å¼€æ³¢æµª..." },
  { "id": 20, "file": "assets/music/song_20.mp3", "title": "ä¸‡æ°´åƒå±±æ€»æ˜¯æƒ…", "options": ["ä¸Šæµ·æ»©", "ä¸‡æ°´åƒå±±æ€»æ˜¯æƒ…", "é“è¡€ä¸¹å¿ƒ"], "answer": "ä¸‡æ°´åƒå±±æ€»æ˜¯æƒ…", "hint": "æ±ªæ˜èƒæ¼”å”±ï¼Œèšæ•£ä¹Ÿæœ‰å¤©æ³¨å®š..." }
];

/**
 * æ¸¸æˆé€»è¾‘
 */
const game = {
    currentLevel: 0,
    isProcessing: false, // é˜²æ­¢è¿ç‚¹
    audioElement: null,

    init: function() {
        this.audioElement = document.getElementById('audio-player');
        
        // éŸ³é¢‘åŠ è½½é”™è¯¯å¤„ç†ï¼ˆæ¨¡æ‹Ÿæ¨¡å¼ï¼‰
        this.audioElement.addEventListener('error', (e) => {
            console.log(`Audio Load Error (Expected in dev): Playing ${GAME_DATA[this.currentLevel].file}`);
            const debugInfo = document.getElementById('debug-info');
            debugInfo.style.display = 'block';
            debugInfo.innerHTML = `(æ¨¡æ‹Ÿæ’­æ”¾ä¸­ï¼š${GAME_DATA[this.currentLevel].title} - ${GAME_DATA[this.currentLevel].file})`;
            
            // æ¨¡æ‹Ÿæ’­æ”¾åŠ¨ç”»
            const icon = document.querySelector('.speaker-icon');
            icon.style.animation = "pulse 0.5s infinite alternate";
        });

        // éŸ³é¢‘æ’­æ”¾ç»“æŸå¤„ç†
        this.audioElement.addEventListener('ended', () => {
             const icon = document.querySelector('.speaker-icon');
             icon.style.animation = "none";
        });
    },

    start: function() {
        document.getElementById('start-screen').classList.remove('active');
        document.getElementById('game-screen').classList.add('active');
        this.loadLevel(0);
    },

    loadLevel: function(index) {
        if (index >= GAME_DATA.length) {
            // æ¸¸æˆé€šå…³ï¼Œé‡ç½®
            alert("æ­å–œæ‚¨ï¼æ‰€æœ‰æ­Œæ›²éƒ½çŒœå¯¹äº†ï¼æˆ‘ä»¬å°†é‡æ–°å¼€å§‹ã€‚");
            index = 0;
        }

        this.currentLevel = index;
        this.isProcessing = false;
        const data = GAME_DATA[index];

        // æ›´æ–°ç•Œé¢
        document.getElementById('current-level-num').textContent = index + 1;
        document.getElementById('debug-info').style.display = 'none';
        document.getElementById('debug-info').textContent = '';

        // ç”Ÿæˆé€‰é¡¹
        const container = document.getElementById('options-container');
        container.innerHTML = '';
        
        data.options.forEach(opt => {
            const btn = document.createElement('button');
            btn.className = 'btn secondary'; // é»˜è®¤æœªé€‰ä¸­çŠ¶æ€ç”¨é‡‘è‰²/é»„è‰²ï¼Œæ˜¾å¾—æ´»è·ƒ
            btn.textContent = opt;
            btn.onclick = () => this.checkAnswer(btn, opt);
            container.appendChild(btn);
        });

        // æ’­æ”¾éŸ³ä¹
        this.playMusic();
    },

    playMusic: function() {
        const data = GAME_DATA[this.currentLevel];
        this.audioElement.src = data.file;
        
        const icon = document.querySelector('.speaker-icon');
        icon.style.animation = "pulse 1s infinite alternate";
        
        this.audioElement.play().catch(e => {
            // è‡ªåŠ¨æ’­æ”¾ç­–ç•¥é™åˆ¶æˆ–æ–‡ä»¶ä¸å­˜åœ¨
            console.warn("Auto-play blocked or file missing. Using fallback UI.");
            // æ‰‹åŠ¨è§¦å‘ error å¤„ç†é€»è¾‘æ¥æ˜¾ç¤ºæ¨¡æ‹Ÿä¿¡æ¯
            this.audioElement.dispatchEvent(new Event('error'));
        });
    },

    checkAnswer: function(btnElement, selectedOption) {
        if (this.isProcessing) return;
        this.isProcessing = true;

        const data = GAME_DATA[this.currentLevel];
        const isCorrect = selectedOption === data.answer;

        // è§†è§‰åé¦ˆ
        if (isCorrect) {
            btnElement.classList.remove('secondary');
            btnElement.classList.add('correct');
            // æ’­æ”¾æ­£ç¡®éŸ³æ•ˆ(å¯é€‰)
            this.showResult(true, data);
        } else {
            btnElement.classList.add('wrong');
            // é«˜äº®æ­£ç¡®ç­”æ¡ˆ
            const buttons = document.querySelectorAll('#options-container button');
            buttons.forEach(b => {
                if (b.textContent === data.answer) {
                    b.classList.remove('secondary');
                    b.classList.add('correct'); // ç”¨ç»¿è‰²é«˜äº®æ­£ç¡®
                }
            });
            this.showResult(false, data);
        }
    },

    showResult: function(isCorrect, data) {
        const modal = document.getElementById('result-modal');
        const icon = document.getElementById('modal-icon');
        const title = document.getElementById('modal-title');
        const desc = document.getElementById('modal-desc');

        // åœæ­¢éŸ³ä¹
        this.audioElement.pause();
        document.querySelector('.speaker-icon').style.animation = "none";

        if (isCorrect) {
            icon.textContent = "ğŸ‰";
            title.textContent = "å¤ªå‰å®³äº†ï¼";
            title.style.color = "#D32F2F";
            desc.textContent = "ç­”æ¡ˆå°±æ˜¯ã€Š" + data.answer + "ã€‹";
        } else {
            icon.textContent = "ğŸ’ª";
            title.textContent = "æ²¡å…³ç³»";
            title.style.color = "#FF9800";
            desc.textContent = "æ­£ç¡®ç­”æ¡ˆæ˜¯ã€Š" + data.answer + "ã€‹";
        }

        setTimeout(() => {
            modal.style.display = "flex";
        }, 800); // ç¨ä½œå»¶è¿Ÿè®©ç”¨æˆ·çœ‹æ¸…æŒ‰é’®å˜åŒ–
    },

    nextLevel: function() {
        document.getElementById('result-modal').style.display = "none";
        this.loadLevel(this.currentLevel + 1);
    }
};

// åˆå§‹åŒ–
game.init();

</script>
</body>
</html>
